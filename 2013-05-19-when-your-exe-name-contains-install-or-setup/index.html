<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="baidu-site-verification" content="codeva-6wmKWl5hmx" />
<meta name="bytedance-verification-code" content="GcOf/MpQ8shZ5Hh/2hvr" />
<meta name="google-site-verification" content="wivqPhuFdISMEKkFZjOWHPYJGSvd716d9R7Bwy2Jj-A" />
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.1.1">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" integrity="sha256-yIDrPSXHZdOZhAqiBP7CKzIwMQmRCJ8UeB8Jo17YC4o=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"www.vvbuys.com","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.19.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="EXE 文件名称中含有 install、update 或者 setup 会导致一些问题，现象和解决方法。">
<meta property="og:type" content="article">
<meta property="og:title" content="可执行文件名中包含 install 或 setup">
<meta property="og:url" content="https://www.vvbuys.com/2013-05-19-when-your-exe-name-contains-install-or-setup/index.html">
<meta property="og:site_name" content="VVbugs Blog">
<meta property="og:description" content="EXE 文件名称中含有 install、update 或者 setup 会导致一些问题，现象和解决方法。">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://www.vvbuys.com/images/posts/windows/pca.png">
<meta property="og:image" content="https://www.vvbuys.com/images/posts/windows/a.png">
<meta property="og:image" content="https://www.vvbuys.com/images/posts/windows/setup.png">
<meta property="og:image" content="https://www.vvbuys.com/images/posts/windows/name.png">
<meta property="article:published_time" content="2024-02-02T01:06:28.200Z">
<meta property="article:modified_time" content="2024-02-02T01:06:28.200Z">
<meta property="article:author" content="vvbuys">
<meta property="article:tag" content="Linux hyprland Python Rust Golang javascript">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://www.vvbuys.com/images/posts/windows/pca.png">


<link rel="canonical" href="https://www.vvbuys.com/2013-05-19-when-your-exe-name-contains-install-or-setup/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://www.vvbuys.com/2013-05-19-when-your-exe-name-contains-install-or-setup/","path":"2013-05-19-when-your-exe-name-contains-install-or-setup/","title":"可执行文件名中包含 install 或 setup"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>可执行文件名中包含 install 或 setup | VVbugs Blog</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">VVbugs Blog</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">standalone Linux lover</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li><li class="menu-item menu-item-sitemap"><a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>Sitemap</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%97%AE%E9%A2%98%E6%8F%8F%E8%BF%B0"><span class="nav-number">1.</span> <span class="nav-text">问题描述</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%97%AE%E9%A2%98%E5%88%86%E6%9E%90"><span class="nav-number">2.</span> <span class="nav-text">问题分析</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88"><span class="nav-number">3.</span> <span class="nav-text">解决方案</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BB%93%E8%AE%BA"><span class="nav-number">4.</span> <span class="nav-text">结论</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">vvbuys</p>
  <div class="site-description" itemprop="description">Share some post and some issue for linux program</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">265</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">36</span>
        <span class="site-state-item-name">categories</span>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">36</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://www.vvbuys.com/2013-05-19-when-your-exe-name-contains-install-or-setup/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="vvbuys">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="VVbugs Blog">
      <meta itemprop="description" content="Share some post and some issue for linux program">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="可执行文件名中包含 install 或 setup | VVbugs Blog">
      <meta itemprop="description" content="EXE 文件名称中含有 install、update 或者 setup 会导致一些问题，现象和解决方法。">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          可执行文件名中包含 install 或 setup
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-02-02 01:06:28" itemprop="dateCreated datePublished" datetime="2024-02-02T01:06:28+00:00">2024-02-02</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Windows/" itemprop="url" rel="index"><span itemprop="name">Windows</span></a>
        </span>
    </span>

  
</div>

            <div class="post-description">EXE 文件名称中含有 install、update 或者 setup 会导致一些问题，现象和解决方法。</div>
        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h3 id="问题描述"><a href="#问题描述" class="headerlink" title="问题描述"></a>问题描述</h3><p>在 Windows Vista+ 系统下，若 EXE 文件名中包含有「install」、「update」或「setup」等字样，可能出现如下问题：</p>
<ol>
<li><p>每次软件运行完退出后会弹出「程序兼容性助手」（Program Compatibility Assistant, 简称 PCA），提示软件未正确安装。</p>
<p><img src="/images/posts/windows/pca.png"></p>
</li>
<li><p>在 Vista+ 的操作系统下任务栏右键该程序缺少「将此程序锁定到任务栏」和软件名同名项。</p>
<table>
<thead>
<tr>
<th>程序名</th>
<th>运行时任务栏右键</th>
</tr>
</thead>
<tbody><tr>
<td>a.exe</td>
<td><img src="/images/posts/windows/a.png"></td>
</tr>
<tr>
<td>setup.exe</td>
<td><img src="/images/posts/windows/setup.png"></td>
</tr>
</tbody></table>
</li>
<li><p>你的程序没打算要求管理员权限的，但是运行的时候却弹 UAC 了。</p>
<p>完全相同的两个 EXE 文件，名字不一样：</p>
<p><img src="/images/posts/windows/name.png"></p>
</li>
</ol>
<h3 id="问题分析"><a href="#问题分析" class="headerlink" title="问题分析"></a>问题分析</h3><p>简而言之，上述现象发生的原因是 Windows Vista+ 系统的「安装程序检测」机制认为文件名中包含「install」、「update」或「setup」等字样，且没有在 Manifest 文件中显式指定 requestedExecutionLevel 的 32 位可执行程序是安装包，会主动为安装包弹出 UAC 提权申请，而「程序兼容性助手」会监控安装包的执行情况，如果它没有在「添加或删除程序」中创建一个条目，那「程序兼容性助手」会认为该安装包没有成功完成，在安装包结束后即弹出「程序兼容性助手」提示用户该程序可能安装不正确。</p>
<p>MSDN 关于「程序兼容性助手」的相关问答：</p>
<blockquote>
<ol>
<li><p>What is the detection logic, and how does PCA know that the setup failed due to version problems?</p>
<p> PCA does not specifically look for the setup’s failing due to version problems. The logic used by PCA is to detect if a setup did not complete successfully. It monitors a program detected as setup by Windows Vista and Windows Server 2008 and checks whether the program registers an entry in Add or Remove Programs (ARP). If no entries are created in ARP, PCA concludes that the installer did not complete successfully. It will then wait for the install program to terminate before displaying the UI. If it is an uninstaller, the detection looks for whether an entry was deleted from ARP.</p>
</li>
<li><p>How does PCA get information about the setup programs?</p>
<p> PCA relies on the User Account Control (UAC) feature in Windows Vista and Windows Server 2008 to know whether a program is a setup program. UAC includes detection for setup programs and will make sure the detected setup programs will be run as Administrator, which includes getting administrative credentials or confirmation from the user before launching the program.</p>
</li>
</ol>
</blockquote>
<p>原文链接：<a target="_blank" rel="noopener" href="https://msdn.microsoft.com/zh-cn/bb756937">Application Compatibility: Program Compatibility Assistant (PCA)</a></p>
<p>MSDN 关于「安装程序检测」的相关介绍：</p>
<blockquote>
<p>Installer Detection only applies to:</p>
<ul>
<li>32 bit executables</li>
<li>Applications without a requestedExecutionLevel</li>
<li>Interactive processes running as a Standard User with UAC enabled</li>
</ul>
<p>Before a 32 bit process is created, the following attributes are checked to determine whether it is an installer:</p>
<ul>
<li>Filename includes keywords like “install,” “setup,” “update,” etc.</li>
<li>Keywords in the following Versioning Resource fields: Vendor, Company Name, Product Name, File Description, Original Filename, Internal Name, and Export Name</li>
<li>Keywords in the side-by-side application manifest embedded in the executable</li>
<li>Keywords in specific StringTable entries linked in the executable</li>
<li>Key attributes in the resource file data linked in the executable</li>
<li>Targeted sequences of bytes within the executable</li>
</ul>
</blockquote>
<p>原文链接：<a target="_blank" rel="noopener" href="https://msdn.microsoft.com/EN-US/library/bb756960(v=VS.10,d=hv.2).aspx">New UAC Technologies for Windows Vista</a></p>
<p>另外，微软的一个 PPT 介绍了「安装程序检测」和它可能产生的误判，以及解决的办法，给出的方案是内嵌 Manifest 或者外置一个名为「MyApp.exe.manifest」的文件：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.google.com.hk/url?sa=t&rct=j&q=&esrc=s&source=web&cd=2&ved=0CCUQFjABahUKEwiPmdW8rYjJAhVHG5QKHQwjBzY&url=http://download.microsoft.com/download/8/C/D/8CD015BB-081B-49C5-A506-9C9B570B8DD2/InstallerDetection.pptx&usg=AFQjCNHXcaCOv_FFndx0mxn7eovywzKQMg">Installer Detection - Microsoft</a></li>
</ul>
<p>参考：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://msdn.microsoft.com/en-us/library/windows/desktop/dd371711(v=vs.85).aspx">Application Manifest</a></li>
<li><a target="_blank" rel="noopener" href="https://msdn.microsoft.com/zh-cn/enus/library/bb963893.aspx">Application Compatibility: UAC: Standard User Changes</a></li>
</ul>
<h3 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h3><p><strong>问题 1：</strong></p>
<p>如下三项任选其一：</p>
<p>一、给程序改个名字，不要包含「install」、「update」和「setup」字样。</p>
<p>二、为可执行文件添加类似如下的 Manifest 文件，指定程序兼容 Win7 与 Vista（或更高版本的当前系统）。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> standalone=<span class="string">&quot;yes&quot;</span>?&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">assembly</span> <span class="attr">xmlns</span>=<span class="string">&quot;urn:schemas-microsoft-com:asm.v1&quot;</span> <span class="attr">manifestVersion</span>=<span class="string">&quot;1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">compatibility</span> <span class="attr">xmlns</span>=<span class="string">&quot;urn:schemas-microsoft-com:compatibility.v1&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">application</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--The ID below indicates application support for Windows Vista --&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">supportedOS</span> <span class="attr">Id</span>=<span class="string">&quot;&#123;e2011457-1546-43c5-a5fe-008deee3d3f0&#125;&quot;</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--The ID below indicates application support for Windows 7 --&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">supportedOS</span> <span class="attr">Id</span>=<span class="string">&quot;&#123;35138b9a-5d96-4fbd-8e2d-a2440225f93a&#125;&quot;</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">application</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">compatibility</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">assembly</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>三、程序运行时在注册表项 <code>HKEY_CURRENT_USER\Software\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Compatibility Assistant\Persisted</code> 下写入以可执行文件全路径为名，值为 REG_DWORD 类型的 1 的项。</p>
<p><strong>问题 2 和 3：</strong></p>
<p>这是 Windows Vista+ 系统对「安装包」的「特殊待遇」，如果你正在做安装包，那你应该不在乎这些；如果你正在做的不是「安装包」，那么将程序改名吧！去掉 install，去掉 update，去掉 setup，世界从此清净了。</p>
<h3 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h3><ol>
<li>如果你正在做的是安装包，那么遵循 Windows Vista+ 系统对安装包的一致规范，主动要求以管理员权限执行，并在安装任务成功完成后在「添加或删除程序」里添加新的条目。</li>
<li>如果不是在做安装包，那么将程序改名能避免 Windows Vista+ 系统的误判导致的问题。</li>
</ol>

    </div>

    
    
    

    <footer class="post-footer">

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2013-06-22-multi-included-source-file/" rel="prev" title="文件被多个中间文件输出目录相同的工程包含">
                  <i class="fa fa-angle-left"></i> 文件被多个中间文件输出目录相同的工程包含
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2013-04-18-windows-ui-notes/" rel="next" title="Windows 界面相关小知识点">
                  Windows 界面相关小知识点 <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">vvbuys</span>
  </div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  






  





</body>
</html>
